--------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/sokbaelee/Dropbox/Persuasion/JPE/Replication Files/scripts/logs/2022.11.02-18.32.11.log.txt
  log type:  text
 opened on:   2 Nov 2022, 18:32:11

. 
. di "Begin date and time: $S_DATE $S_TIME"
Begin date and time:  2 Nov 2022 18:32:11

. di "Stata version: `c(stata_version)'"
Stata version: 17

. di "Updated as of: `c(born_date)'"
Updated as of: 23 Aug 2022

. di "Variant:       `=cond( c(MP),"MP",cond(c(SE),"SE",c(flavor)) )'"
Variant:       MP

. di "Processors:    `c(processors)'"
Processors:    4

. di "OS:            `c(os)' `c(osdtl)'"
OS:            MacOSX 12.5.1

. di "Machine type:  `c(machine_type)'"
Machine type:  Mac (Apple Silicon)

. 
. * Stata version control
. version 17

. 
. * Create directories for output files
. cap mkdir "$Persuasion/results"

. 
. **********************
. * Run analysis
. **********************
. * TABLE 1. Persuasion Rates: Papers on Voter Turnout
. do "$Persuasion/scripts/table1.do"

. ************
. * SCRIPT:   table1.do
. * PURPOSE:  Creates Table 1
. ************
. 
. * input for table 1
. matrix turnout = ///
>   ( 0.472, 0.448, 0.279, 0 \ ///
>         0.310, 0.286, 0.293, 0 \ ///
>         0.711, 0.660, 0.737, 0 \ ///
>         0.416, 0.405, 0.414, 0 \ ///
>         0.455, 0.435, 0.800, 0 \ ///
>         0.700, 0.690, 0.250, 0 )

.         
. matrix results = J(1,5,.)

.         
. foreach j of numlist 1/6 {      
  2. 
.         display `j'
  3. 
.         scalar y1 = turnout[`j',1]
  4.         scalar y0 = turnout[`j',2]
  5.         scalar e1 = turnout[`j',3]
  6.         scalar e0 = turnout[`j',4]
  7. 
.         calc4persuasio y1 y0 e1 e0
  8.         
.         scalar persuasion_DK = (y1-y0)/((e1-e0)*(1-y0))
  9. 
.         matrix results = results \ (persuasion_DK, r(apr_lb), r(apr_ub), r(lpr_lb), r(lpr_ub)) 
 10. 
. }
1
 
--------------------------------------------------------------
calc4persuasio: Calculate the effect of persuasion when info.
   on Pr(y=1|z) and/or Pr(t=1|z) for each z=0,1 is available
 
---------------------------------------------------------------
               Parameter | Lower Bound       Upper Bound 
-------------------------+-------------------------------------
 Average Persuasion Rate |  .043478                  1 
   Local Persuasion Rate |  .086022                  1 
---------------------------------------------------------------

2
 
--------------------------------------------------------------
calc4persuasio: Calculate the effect of persuasion when info.
   on Pr(y=1|z) and/or Pr(t=1|z) for each z=0,1 is available
 
---------------------------------------------------------------
               Parameter | Lower Bound       Upper Bound 
-------------------------+-------------------------------------
 Average Persuasion Rate |  .033613                  1 
   Local Persuasion Rate |  .081911                  1 
---------------------------------------------------------------

3
 
--------------------------------------------------------------
calc4persuasio: Calculate the effect of persuasion when info.
   on Pr(y=1|z) and/or Pr(t=1|z) for each z=0,1 is available
 
---------------------------------------------------------------
               Parameter | Lower Bound       Upper Bound 
-------------------------+-------------------------------------
 Average Persuasion Rate |      .15            .923529 
   Local Persuasion Rate |      .15                  1 
---------------------------------------------------------------

4
 
--------------------------------------------------------------
calc4persuasio: Calculate the effect of persuasion when info.
   on Pr(y=1|z) and/or Pr(t=1|z) for each z=0,1 is available
 
---------------------------------------------------------------
               Parameter | Lower Bound       Upper Bound 
-------------------------+-------------------------------------
 Average Persuasion Rate |  .018487                  1 
   Local Persuasion Rate |   .02657                  1 
---------------------------------------------------------------

5
 
--------------------------------------------------------------
calc4persuasio: Calculate the effect of persuasion when info.
   on Pr(y=1|z) and/or Pr(t=1|z) for each z=0,1 is available
 
---------------------------------------------------------------
               Parameter | Lower Bound       Upper Bound 
-------------------------+-------------------------------------
 Average Persuasion Rate |  .035398            .389381 
   Local Persuasion Rate |  .035398                  1 
---------------------------------------------------------------

6
 
--------------------------------------------------------------
calc4persuasio: Calculate the effect of persuasion when info.
   on Pr(y=1|z) and/or Pr(t=1|z) for each z=0,1 is available
 
---------------------------------------------------------------
               Parameter | Lower Bound       Upper Bound 
-------------------------+-------------------------------------
 Average Persuasion Rate |  .032258                  1 
   Local Persuasion Rate |      .04                  1 
---------------------------------------------------------------


. 
. matrix results = 100*results[2..7,1..5]

. 
. frmttable using "$Persuasion/results/table1", statmat(results) tex replace sdec(1) ///
>         ctitles("", DK, APR (LB), APR (UB), LPR (LB), LPR (UB) )  ///
>         rtitles("Green and Gerber (2000)" \ "Green, Gerber, and Nickerson (2003)" \ ///
>         "Green and Gerber (2001)" \ "Green and Gerber (2001)" \    ///
>         "Gentzkow (2006)" \ "Gentzkow, Shapiro, and Sinkinson (2011)")  ///
>         title("Persuasion Rates: Papers on Voter Turnout")

                                        Persuasion Rates: Papers on Voter Turnout
                ------------------------------------------------------------------------------------------
                                                            DK   APR (LB)  APR (UB)  LPR (LB)  LPR (UB)  
                ------------------------------------------------------------------------------------------
                 Green and Gerber (2000)                   15.6    4.3      100.0      8.6       100.0   
                 Green, Gerber, and Nickerson (2003)       11.5    3.4      100.0      8.2       100.0   
                 Green and Gerber (2001)                   20.4    15.0      92.4      15.0      100.0   
                 Green and Gerber (2001)                   4.5     1.8      100.0      2.7       100.0   
                 Gentzkow (2006)                           4.4     3.5       38.9      3.5       100.0   
                 Gentzkow, Shapiro, and Sinkinson (2011)   12.9    3.2      100.0      4.0       100.0   
                ------------------------------------------------------------------------------------------


. 
end of do-file

. 
. * Effects of Uncensored Media: Revisiting Chen and Yang (2019)
. *   To generate the dataset "ChenYang2019.dta", it is necessary to run CY19_data.do 
. *   after downloading the original dataset from 
. *   the AER webpage at https://www.aeaweb.org/articles?id=10.1257/aer.20171765
. *   and storing them at "$Persuasion/data/ChenYang2019".
. *   As the dataset is already created and stored at "$Persuasion/data/ChenYang2019", 
. *   the do file is commented below.
. *do "$Persuasion/scripts/CY19_data.do"
. *   TABLE 2. Persuasion Rates of Exposure to Uncensored Internet
. do "$Persuasion/scripts/table2.do"

. ************
. * SCRIPT:   table2.do
. * PURPOSE:  Creates Table 2
. ************
. 
.         use "$Persuasion/data/ChenYang2019/ChenYang2019.dta", clear

. 
.         matrix results = J(1, 5, .)

.         qui reg active_user treatment_vpnonly treatment_nlonly treatment_vpnnl, r

.         local share_compliers = _b[treatment_vpnnl]

.                         
.         // persuasion rates for panel variables
.         foreach Y in info_foreign_website ///   A.1.2 Ranked high: foreign websites
>                                  info_freq_website_for ///      A.1.6 Freq. of visiting foreign websites for info.
>                                  az_belief_media_value ///      A.3 Valuation of access to foreign media outlets
>                                  az_belief_media_trust ///      A.4 Trust in non-domestic media outlets
>                                  bias_domestic ///                      A.5.1 Degree of censorship on domestic news outl
> ets     
>                                  bias_foreign ///       A.5.2 Degree of censorship on foreign news outlets      
>                                  az_belief_media_justif /// A.6 Censorship unjustified
>                                  bias_dom_govt_policy_t1 ///  A.7.1 Domestic cens. driven by govt. policies
>                                  bias_for_govt_policy_t1 /// A.7.2 Foreign cens. driven by govt. policies
>                 {
  2.                                 
.                 qui reg `Y'_w3_p treatment_vpnonly treatment_nlonly treatment_vpnnl, r
  3.                 qui summ `Y'_w1_p if treatment_vpnnl == 1
  4.                 local persuasion_DK = _b[treatment_vpnnl]/(`share_compliers'*(1-`r(mean)'))
  5.                                 
.                 persuasio apr `Y'_w3_p active_user treatment_vpnnl ///
>                                         if (treatment_main == 1) | (treatment_main == 3), ///
>                                         method("bootstrap") nboot("nbt")
  6. 
.                 matrix pers_res = (e(apr_est) \ e(apr_ci))
  7.                 
.                 persuasio lpr `Y'_w3_p active_user treatment_vpnnl ///
>                                         if (treatment_main == 1) | (treatment_main == 3), ///
>                                         method("bootstrap") nboot("nbt")
  8.                                         
.                 matrix CY = (`persuasion_DK' \ .)                       
  9.                 matrix pers_res = (pers_res, ( (e(lpr_est), .) \ e(lpr_ci)))
 10.                 matrix results = results \ ( CY , pers_res)
 11.                                 
.                 }
nboot() invalid -- invalid numlist
r(121);

end of do-file
r(121);

end of do-file

r(121);

. do "/var/folders/x8/k6zkc0lx26n8v33jzvdvv1qc0000gn/T//SD79647.000000"

. **********************
. * OVERVIEW
. *   This script generates selected tables for the paper:
. *       "IDENTIFYING THE EFFECT OF PERSUASION" (Sung Jae Jun and Sokbae Lee)
. *   All data are stored in /data
. *   All tables are outputted to /results
. * 
. * SOFTWARE REQUIREMENTS
. *   Stata version 17 or newer
. *
. * TO PERFORM A CLEAN RUN, DELETE THE FOLLOWING FOLDER:
. *   $Persuasion/results
. *
. * ACKNOWLEDGMENT
. *       The structure of the replication files is forked from 
. *   Illinois Workplace Wellness Study: Public Use Data Repository
. *   at https://github.com/reifjulian/illinois-wellness-data
. **********************
. 
. **********************
. * Parameters defined by user
. **********************
. 
. * "Persuasion" points to the root directory, which contains the subfolders "data" and "scripts"
. global Persuasion "/Users/sokbaelee/Dropbox/Persuasion/JPE/Replication Files"

. 
. * Number of bootstraps for Table 2
. * The published paper used nboot = 1000. Runtime is approximately ??? hours on a Windows 10 Desktop with Stata MP-6 and 
> an i7-8700 CPU 3.20 GHz processor
. * Use smaller value to run replication code faster. Runtime is approximately 1 minute with nboot = 2.
. global nbt = 10

. 
. * set seed for replicablilty 
. set seed 987975 

. 
. **********************
. **********************
. 
. * Confirm that the global for the root directory has been defined
. assert !missing("$Persuasion")

. 
. * Initialize log and record system parameters
. clear 

. set more off

. cap mkdir "$Persuasion/scripts/logs"

. cap log close
